<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Testing</title>
    <!-- Bootstrap core CSS -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../css/prompto-frame.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/lib/jquery.min.js"></script>
    <script src="../../js/lib/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../js/lib/ie10-viewport-bug-workaround.js"></script>

    <script type="text/javascript">

        var samples =  {
            c1 : 'define "2 numbers can be added" as test method doing:'
            + "\n" + '    a = 3'
            + "\n" + '    b = 8'
            + "\n" + 'and verifying:'
            + "\n" + '    a + b = 11',
            c2 : 'define "2 numbers can be added" as test method doing:'
            + "\n" + '    a = 3'
            + "\n" + '    b = 8'
            + "\n" + 'and verifying:'
            + "\n" + '    a + b = 11'
            + "\n" + '    a = 11'
            + "\n" + '    b is a Text'
            + "\n" + '    b = 8',
            c3 : 'define "divide by 0 raises error" as test method doing:'
            + "\n" + '    a = 3 / 0'
            + "\n" + 'and verifying DIVIDE_BY_ZERO',
            c4 : 'define Person as storable category with attribute name'
            + "\n"
            + "\n" + 'define "person can be fetched by name" as test method doing:'
            + "\n" + '    p = Person with "John" as name'
            + "\n" + '    store p'
            + "\n" + '    found = fetch one Person where name = "John"'
            + "\n" + 'and verifying:'
            + "\n" + '    found.name = "John"'

        };

        function editorReady(frame, editor) {
            editor.setValue(samples[frame.name], -1);
        }

        function translatePromptoCode(content, from, to, editor) {
            parent.translatePromptoCode(content, from, to, editor);
        }

        function executePromptoCode(content, dialect, printer) {
            parent.executePromptoCode(content, dialect, printer);
        }


    </script>
</head>
<body>
<div class="container">
    <div class="row">
        <h2>Testing</h2>

        <p>Prompto promotes Test Driven Development (TDD) and automated testing.
            TDD is <a target="_blank" href="https://en.wikipedia.org/wiki/Test-driven_development">a development approach</a>
            where you write tests before writing code. There are numerous benefits to it:
            <ul>
                <li>you gain a better understanding of the requirement before you start writing the code</li>
                <li>you build a large number of tests which cover most if not all use cases</li>
            </ul>
        </p>
        <p>To encourage TDD, Prompto has a built-in testing framework, based on special methods called test methods.</p>
        <p>Here is an example:</p>
        <div>
            <iframe class="displayer" name="c1" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>
        <p/>
        <p>Test methods make it very easy to write tests before code, and even run them using the interpreter. The test will obviously fail until
        the correct code is implemented, which ensures that writing code actually does something: fix the test!</p>
        <h3>Test method structure</h3>
        <p>The structure of a test method is the following:
            <ul>
                <li><code>define &lt;"<i>test name</i>"&gt; as test method doing:</code></li>
                <li><i>    Prompto code being tested</i></li>
                <li><code>and verifying:</code></li>
                <li><i>    Prompto verification code</i></li>
            </ul>
        where <i>"test name"</i> is a free text literal (the only restriction being that the name must be unique),
        and <i>Prompto verification code</i> is a list of one or more predicates i.e. boolean expressions.</p>
        <p>Thanks to this structure, Prompto tests can check multiple predicates even if not all of them succeed, as in the below example:</p>
        <div>
            <iframe class="displayer displayer-8-lines" name="c2" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>
        <p/>
        <h3>Testing errors</h3>
        <p>Alternately, test methods can be used to check correct error handling. Here is an example:</p>
        <div>
            <iframe class="displayer" name="c3" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>
        <h3>Testing stored data</h3>
        <p>It is generally a bad idea to test against a permanent data store, because it means that the test success relies on the state
            of a data store which cannot be controlled by the test itself. To facilitate testing involving stored data, Prompto creates
            a fresh memory store before the test runs (the store is disposed immediately after execution of the test).</p>
        <p>A reliable test involving stored data might look like the following:</p>
        <div>
            <iframe class="displayer displayer-8-lines" name="c4" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>
    </div>
</body>
</html>