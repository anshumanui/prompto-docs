<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Resources</title>
    <!-- Bootstrap core CSS -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../css/prompto-frame.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/lib/jquery.min.js"></script>
    <script src="../../js/lib/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../js/lib/ie10-viewport-bug-workaround.js"></script>

    <script type="text/javascript">

        var samples =  {
            c1 : "define main as method doing:"
            + "\n" + '    location = "https://raw.githubusercontent.com/prompto/prompto-samples/master/sample-text-file.txt"'
            + "\n" + '    content = read all from Url with location as path'
            + "\n" + '    print content',
            c2 : "define main as method doing:"
            + "\n" + '    location = "https://raw.githubusercontent.com/prompto/prompto-samples/master/sample-text-file.txt"'
            + "\n" + '    with url = Url with location as path, do:'
            + "\n" + '        line = read one from url'
            + "\n" + '        print "line -> " + line'
            + "\n" + '        line = read one from url'
            + "\n" + '        print "line -> " + line'
            + "\n" + '        line = read one from url'
            + "\n" + '        print "line -> " + line',
            c3 : "define main as method doing:"
            + "\n" + '    content = "some content"'
            + "\n" + '    write content to Buffer'
            + "\n" + '    print "\'" + content + "\' -> has been written to Buffer"',
            c4 : "define main as method doing:"
            + "\n" + '    content = "<empty>"'
            + "\n" + '    with buffer = Buffer, do:'
            + "\n" + '        write "some content" to buffer'
            + "\n" + '        write "other content" to buffer'
            + "\n" + '        // read back the 2 above lines'
            + "\n" + '        content = read all from buffer'
            + "\n" + '    print content'

        };

        function editorReady(frame, editor) {
            editor.setValue(samples[frame.name], -1);
        }

        function translatePromptoCode(content, from, to, editor) {
            parent.translatePromptoCode(content, from, to, editor);
        }

        function executePromptoCode(content, dialect, printer) {
            parent.executePromptoCode(content, dialect, printer);
        }

    </script>
</head>
<body>
<div class="container">
    <div class="row">
        <h2>Resources</h2>

        <p>Some system resources require careful handling. For example, when you open a file for writing, the file is locked and becomes unavailable for reading by other programs,
            or other parts of your application. Similar constraints apply to other objects: network objects such as Urls, database connections, and so on.</p>
        <p>A Prompto <code>resource</code> is a specialized native category designed to take care of these precious resources, and free them automatically as soon as possible.
            To achieve this, Prompto requires resources to be either <i>inlined</i> or <i>managed</i>. An <i>inlined</i> resource is one that is not assigned to a variable,
            but rather used as an expression, and cannot therefore be accessed more than once. A <i>managed</i> resource is one that is protected using a <code>with</code> block.</p>
        <p>It is illegal to <code>read</code> or <code>write</code> a resource which is neither <i>managed</i> nor <i>inlined</i>.</p>
        <p>Prompto resources are used to read and write text. There is no support for binary data. If required, binary data should be handled and converted to or from Prompto objects using the host language.</p>

        <h3>Reading text from a resource</h3>

        <p><i>In the below examples, we use a Url resource. File resources are not accessible from a browser.</i></p>

        <p>Prompto resources can be used to read text, either line per line, or all lines at once.</p>

        <h4>Read all the text from an <i>inlined</i> resource</h4>

        <p>When reading all the lines at once, you can simply specify the resource as a parameter to the <code>read all</code> statement.</p>

        <div>
            <iframe class="displayer" name="c1" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>

        <h4>Read the text line by line from a <i>managed</i> resource</h4>

        <p>To read the text line by line, you must <i>manage</i> the resource using a <code>with</code> block:</p>

        <div>
            <iframe class="displayer displayer-10-lines" name="c2" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>

        <h3>Writing text to a resource</h3>

        <p><i>In the below examples, we use a Buffer resource. File resources are not accessible from a browser.</i></p>

        <p>Prompto can write text to resources, either line per line, or all lines at once.</p>

        <h4>Writing all the text to an <i>inlined</i> resource</h4>

        <p>When writing all the text at once, you can simply specify the resource as a parameter to the <code>write</code> statement.</p>

        <div>
            <iframe class="displayer" name="c3" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>

        <h4>Writing the text line by line to a <i>managed</i> resource</h4>

        <p>To write the text line by line, you must <i>manage</i> the resource using a <code>with</code> block:</p>

        <div>
            <iframe class="displayer displayer-10-lines" name="c4" class="embed-responsive-item" src="../../code/displayer.html" runnable></iframe>
        </div>


        <h3>Prompto native resource specification</h3>
        <p>A Prompto native resource must implement:
            <ul>
                <li>a <i>close</i> method, which is called automatically by Prompto when appropriate. This method cannot be called directly by Prompto code.</li>
                <li>a <i>isReadable</i> method, which is called to check whether a resource supports <code>read</code> methods</li>
                <li>a <i>isWritable</i> method, which is called to check whether a resource supports <code>write</code> methods</li>
                <li>a <i>readLine</i> method, which must return the <i>next</i> line of text from the resource, or <code>null</code> if no more data is available</li>
                <li>a <i>readFully</i> method, which must return the entire text from the resource, or <code>null</code> if no data is available</li>
                <li>a <i>writeLine</i> method, which must <i>append</i> a line of text to the resource</li>
                <li>a <i>writeFully</i> method, which must <i>overwrite</i> the entire content of the resource with the incoming text</li>
            </ul>
            <i><a target="_blank" href="https://github.com/prompto/prompto-libraries/blob/master/console/buffer.pec">see an example in Prompto</a></i><br/>
            <i><a target="_blank" href="https://github.com/prompto/prompto-java/blob/master/Java-Runtime/src/main/java/prompto/io/Buffer.java">see an example in Java</a></i><br/>
            <i><a target="_blank" href="https://github.com/prompto/prompto-csharp/blob/master/CSharp-Runtime/src/prompto/io/Buffer.cs">see an example in C#</a></i><br/>
            <i><a target="_blank" href="https://github.com/prompto/prompto-python2/blob/master/Python2-Runtime/src/main/prompto/io/Buffer.py">see an example in Python</a></i><br/>
            <i><a target="_blank" href="https://github.com/prompto/prompto-javascript/blob/master/JavaScript-Runtime/src/main/prompto/io/Buffer.js">see an example in JavaScript</a></i>
        </p>

    </div>
</body>
</html>